<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="portabilis_atestado_vaga" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="instituicao" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="escola" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="curso" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="serie" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="aluno" class="java.lang.String">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="ano" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="data_validade" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT public.fcn_upper(nm_instituicao) AS nome_instituicao,
       instituicao.cidade AS cidade_instituicao,
       public.fcn_upper(ref_sigla_uf) AS uf_instituicao,
       escola.cod_escola AS cod_escola,
       escola_ano_letivo.ano,
       public.fcn_upper(pessoa.nome) AS nm_escola,
(SELECT fcn_upper(ps.nome)
          FROM cadastro.pessoa ps,
               cadastro.juridica
         WHERE escola.ref_idpes = juridica.idpes AND
               juridica.idpes = ps.idpes) AS nm_escola,

      (SELECT fcn_upper(substring(logradouro.idtlog from 1 for 1)) ||
              lower(substring(logradouro.idtlog, 2))
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes) AS tipo_logradouro,

      (SELECT logradouro.nome
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes) AS logradouro,
      (SELECT bairro.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS bairro,
      (SELECT municipio.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS municipio,
      (SELECT endereco_pessoa.numero
         FROM cadastro.endereco_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS numero,
      (SELECT municipio.sigla_uf
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS uf_municipio,
     (SELECT min(fone_pessoa.ddd)
         FROM cadastro.fone_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS fone_ddd,

     (SELECT to_char(endereco_pessoa.cep, '99999-999')
         FROM cadastro.endereco_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS cep,
     (SELECT min(to_char(fone_pessoa.fone, '9999-9999'))
         FROM cadastro.fone_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes) AS fone,
     (SELECT ps.email
         FROM cadastro.pessoa ps,
              cadastro.juridica
        WHERE juridica.idpes = ps.idpes AND
              juridica.idpes = escola.ref_idpes) AS email,
       curso.nm_curso,
       serie.nm_serie,
       to_char(CURRENT_DATE,'dd/mm/yyyy') AS data_atual,
       to_char(current_timestamp, 'HH24:MI:SS') AS hora_atual,
       (select CASE WHEN (select min(to_char(turma.hora_inicial,'HH'))
                     from pmieducar.turma
                    where turma.ref_ref_cod_escola = escola_serie.ref_cod_escola and
                          turma.ref_ref_cod_serie = escola_serie.ref_cod_serie and
                          escola_serie.ref_cod_escola = escola.cod_escola) = '07' THEN 'Matutino'
                    WHEN (select min(to_char(turma.hora_inicial,'HH'))
                     from pmieducar.turma
                    where turma.ref_ref_cod_escola = escola_serie.ref_cod_escola and
                          turma.ref_ref_cod_serie = escola_serie.ref_cod_serie and
                          escola_serie.ref_cod_escola = escola.cod_escola) = '08' THEN 'Matutino'
        ELSE 'Vespertino'
        END) as periodo

  FROM pmieducar.instituicao,
       pmieducar.escola,
       cadastro.pessoa,
       pmieducar.escola_ano_letivo,
       pmieducar.escola_curso,
       pmieducar.escola_serie,
       pmieducar.curso,
       pmieducar.serie

 WHERE escola_ano_letivo.ano = $P{ano} AND
       instituicao.cod_instituicao = $P{instituicao} AND
       escola.cod_escola = $P{escola} AND
       curso.cod_curso = $P{curso} AND
       serie.cod_serie = $P{serie} AND
       escola_serie.ref_cod_serie = serie.cod_serie AND
       escola_curso.ref_cod_curso = curso.cod_curso AND
       escola_curso.ref_cod_escola = escola.cod_escola AND
       escola_serie.ref_cod_escola = escola.cod_escola AND
       escola.ref_cod_instituicao = instituicao.cod_instituicao AND
       escola.ref_idpes = pessoa.idpes AND
       escola_ano_letivo.ref_cod_escola = escola.cod_escola AND
       escola.ativo = 1]]>
	</queryString>
	<field name="nome_instituicao" class="java.lang.String"/>
	<field name="cidade_instituicao" class="java.lang.String"/>
	<field name="uf_instituicao" class="java.lang.String"/>
	<field name="cod_escola" class="java.lang.Integer"/>
	<field name="ano" class="java.lang.Integer"/>
	<field name="nm_escola" class="java.lang.String"/>
	<field name="tipo_logradouro" class="java.lang.String"/>
	<field name="logradouro" class="java.lang.String"/>
	<field name="bairro" class="java.lang.String"/>
	<field name="municipio" class="java.lang.String"/>
	<field name="numero" class="java.math.BigDecimal"/>
	<field name="uf_municipio" class="java.lang.String"/>
	<field name="fone_ddd" class="java.math.BigDecimal"/>
	<field name="cep" class="java.lang.String"/>
	<field name="fone" class="java.lang.String"/>
	<field name="email" class="java.lang.String"/>
	<field name="nm_curso" class="java.lang.String"/>
	<field name="nm_serie" class="java.lang.String"/>
	<field name="data_atual" class="java.lang.String"/>
	<field name="hora_atual" class="java.lang.String"/>
	<field name="periodo" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="613" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="103" y="52" width="201" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA["Fone/Fax: ("+$F{fone_ddd}+") "+$F{fone}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="185" y="108" width="179" height="16"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[ATESTADO DE VAGA]]></text>
			</staticText>
			<staticText>
				<reportElement x="102" y="16" width="278" height="13"/>
				<textElement>
					<font size="8" isBold="true" pdfEncoding="Cp1252" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[SECRETARIA MUNICIPAL DE EDUCAÇÃO E CULTURA]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="359" y="52" width="120" height="13" forecolor="#000033"/>
				<textElement>
					<font size="8" isBold="true" isItalic="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["E-mail: "+$F{email}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="102" y="40" width="253" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{tipo_logradouro}+" "+$F{logradouro}+", "+$F{numero}+"            Bairro" +$F{bairro}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="102" y="28" width="222" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nm_escola}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="110" y="248" width="295" height="20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Certidão de Nascimento ou carteira de identidade (cópia);]]></text>
			</staticText>
			<staticText>
				<reportElement x="110" y="282" width="295" height="20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Comprovante de Residência (cópia);]]></text>
			</staticText>
			<staticText>
				<reportElement x="110" y="313" width="295" height="20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Histórico Escolar (original);]]></text>
			</staticText>
			<staticText>
				<reportElement x="110" y="344" width="295" height="20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Atestado de Frequência (original).]]></text>
			</staticText>
			<staticText>
				<reportElement x="110" y="418" width="295" height="20"/>
				<textElement>
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Notas parciais;]]></text>
			</staticText>
			<staticText>
				<reportElement x="53" y="390" width="352" height="20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[No caso de transferência durante o ano, apresentar também:]]></text>
			</staticText>
			<staticText>
				<reportElement x="111" y="450" width="295" height="20"/>
				<textElement>
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Boletim de notas dos trimestres concluídos.]]></text>
			</staticText>
			<rectangle>
				<reportElement x="86" y="253" width="14" height="10"/>
			</rectangle>
			<rectangle>
				<reportElement x="86" y="286" width="14" height="10"/>
			</rectangle>
			<rectangle>
				<reportElement x="86" y="318" width="14" height="10"/>
			</rectangle>
			<rectangle>
				<reportElement x="86" y="349" width="14" height="10"/>
			</rectangle>
			<rectangle>
				<reportElement x="86" y="423" width="14" height="10"/>
			</rectangle>
			<rectangle>
				<reportElement x="86" y="455" width="14" height="10"/>
			</rectangle>
			<textField>
				<reportElement x="53" y="580" width="352" height="20"/>
				<textElement markup="none">
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{cidade_instituicao}+" ("+$F{uf_instituicao}+")"+",  "+$F{data_atual}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="53" y="524" width="311" height="16"/>
				<textElement markup="none">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["OBSERVAÇÃO: O prazo de vencimento, para entrega dos documentos será até o dia:"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="412" y="4" width="126" height="13"/>
				<textElement>
					<font size="7" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Emissão: "+$F{data_atual}+" "+$F{hora_atual}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="35" y="167" width="503" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Atestamos para os devidos fins e a pedido da parte interessada, que há vaga no(a) "+$F{nm_serie}+" do "+$F{nm_curso}+" , no turno"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="35" y="183" width="503" height="15"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{periodo}+", para o ano letivo de "+$F{ano}+", podendo ser aceita a matrícula por transferência do(a) aluno(a) "+$P{aluno}+" desde que apresente a documentação exigida:"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="102" y="4" width="278" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nome_instituicao}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="363" y="524" width="100" height="16"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{data_validade}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="358" y="40" width="77" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["CEP: "+$F{cep}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="468" y="39" width="77" height="13"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{municipio}+" - "+$F{uf_municipio}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="22" y="4" width="57" height="46"/>
				<imageExpression class="java.lang.String"><![CDATA["/home/portabilis/www/ieducar/intranet/imagens/brasao.jpg"]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="15" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="19" splitType="Stretch"/>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
