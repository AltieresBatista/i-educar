<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="portabilis_boletim_semestral" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="88dd3030-4aea-4a2a-90b2-2d9f72f62efc">
	<property name="ireport.zoom" value="1.3310000000000035"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="ano" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="instituicao" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="escola" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="curso" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="serie" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="turma" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="matricula" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="logo" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT (SELECT escola_ano_letivo.ano
          FROM pmieducar.escola_ano_letivo
         WHERE escola_ano_letivo.ref_cod_escola = $P{escola} and
		       ano = $P{ano}) AS ano,

      (SELECT public.fcn_upper(instituicao.nm_responsavel)
         FROM pmieducar.instituicao
        WHERE instituicao.cod_instituicao = $P{instituicao}) AS nome_responsavel,

      (SELECT COALESCE((SELECT public.fcn_upper(ps.nome)
          FROM cadastro.pessoa ps,
               cadastro.juridica,
               pmieducar.escola
         WHERE escola.ref_idpes = juridica.idpes AND
               juridica.idpes = ps.idpes AND
               escola.cod_escola = $P{escola}),(SELECT nm_escola FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS nm_escola,


      (SELECT public.fcn_upper(instituicao.nm_instituicao)
         FROM pmieducar.instituicao
        WHERE instituicao.cod_instituicao = $P{instituicao}) AS nome_instituicao,

      (SELECT public.fcn_upper(substring(logradouro.idtlog from 1 for 1)) ||
              lower(substring(logradouro.idtlog, 2))
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa,
              pmieducar.escola
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}) AS tipo_logradouro,

      (SELECT COALESCE((SELECT COALESCE((SELECT logradouro.nome
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa,
              pmieducar.escola
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT endereco_externo.logradouro FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(SELECT logradouro FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS logradouro,

      (SELECT COALESCE((SELECT COALESCE((SELECT municipio.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro,
              pmieducar.escola
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT endereco_externo.cidade FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(SELECT municipio FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS municipio,

      (SELECT COALESCE((SELECT COALESCE((SELECT bairro.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro,
              pmieducar.escola
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT endereco_externo.bairro FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(SELECT bairro FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS bairro,

      (SELECT COALESCE((SELECT COALESCE((SELECT municipio.sigla_uf
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro,
              pmieducar.escola
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT endereco_externo.sigla_uf FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(select inst.ref_sigla_uf from pmieducar.instituicao inst where inst.cod_instituicao = $P{instituicao}))) AS uf_municipio,

      (SELECT COALESCE((SELECT COALESCE((SELECT endereco_pessoa.numero
         FROM cadastro.endereco_pessoa,
              cadastro.juridica,
              pmieducar.escola
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT endereco_externo.numero FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(SELECT numero FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS numero,

     (SELECT COALESCE((SELECT COALESCE((SELECT to_char(endereco_pessoa.cep, '99999-999')
         FROM cadastro.endereco_pessoa,
              cadastro.juridica,
              pmieducar.escola
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT to_char(endereco_externo.cep,'99999-999') FROM cadastro.endereco_externo, pmieducar.escola WHERE endereco_externo.idpes = escola.ref_idpes AND escola.cod_escola = $P{escola}))),(SELECT to_char(escola_complemento.cep,'99999-999') FROM pmieducar.escola_complemento where escola_complemento.ref_cod_escola = $P{escola}))) AS cep,

     (SELECT COALESCE((SELECT min(fone_pessoa.ddd)
         FROM cadastro.fone_pessoa,
              cadastro.juridica,
              pmieducar.escola
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT min(ddd_telefone) FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS fone_ddd,


     (SELECT COALESCE((SELECT min(to_char(fone_pessoa.fone, '9999-9999'))
         FROM cadastro.fone_pessoa,
              cadastro.juridica,
              pmieducar.escola
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT min(to_char(telefone, '9999-9999')) FROM pmieducar.escola_complemento where escola_complemento.ref_cod_escola = $P{escola}))) AS fone,

     (SELECT COALESCE((SELECT ps.email
         FROM cadastro.pessoa ps,
              cadastro.juridica,
              pmieducar.escola
        WHERE juridica.idpes = ps.idpes AND
              juridica.idpes = escola.ref_idpes AND
              escola.cod_escola = $P{escola}),(SELECT email FROM pmieducar.escola_complemento where ref_cod_escola = $P{escola}))) AS email,

       to_char(current_date,'dd/mm/yyyy') AS data_atual,
       to_char(current_timestamp, 'HH24:MI:SS') AS hora_atual,

        nome_disciplina,
        MAX(matricula) as matricula,
        MAX(id_disciplina) as id_disciplina,
	MAX(nota1) AS nota1,
        MAX(nota2) AS nota2,
        MAX(nota3) AS nota3,
        MAX(nota4) AS nota4,
		MAX(nota_exame) AS nota_exame,
		MAX(media) AS media,
        MAX(nome_curso) AS nome_curso,
	MAX(nome_serie) AS nome_serie,
        MAX(nome_turma) AS nome_turma,
        MAX(periodo) AS periodo,
		MAX(situacao) AS situacao,
		MAX(nome_aluno) AS nome_aluno,
		MAX(total_faltas_et1) AS total_faltas_et1,
		MAX(total_faltas_et2) AS total_faltas_et2,
		MAX(total_faltas_et3) AS total_faltas_et3,
		MAX(total_faltas_et4) AS total_faltas_et4,
		MAX(total_faltas) AS total_faltas,
		MAX(faltas_componente_et1) AS faltas_componente_et1,
		MAX(faltas_componente_et2) AS faltas_componente_et2,
		MAX(faltas_componente_et3) AS faltas_componente_et3,
		MAX(faltas_componente_et4) AS faltas_componente_et4,
		MAX(total_faltas_componente) AS total_faltas_componente,
                    MAX(total_geral_faltas_componente) AS total_geral_faltas_componente,
		MAX(frequencia) AS frequencia,
		MAX(carga_horaria_componente) AS carga_horaria_componente,
                    MAX(curso_hora_falta) AS curso_hora_falta,
		MAX(carga_horaria) AS carga_horaria,
                     MAX(carga_horaria_serie) AS carga_horaria_serie
  FROM (SELECT
             componente_curricular.nome as nome_disciplina,

               matricula.cod_matricula AS matricula,

              componente_curricular.id as id_disciplina,

       (SELECT CASE  WHEN nota_componente_curricular.nota_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular.nota_arredondada) = 1 THEN
			                   replace(nota_componente_curricular.nota_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular.nota_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular,
	           modules.nota_aluno
	     WHERE nota_componente_curricular.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula AND
             nota_componente_curricular.etapa = 1
      ) AS nota1,

       (SELECT CASE  WHEN nota_componente_curricular.nota_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular.nota_arredondada) = 1 THEN
			                   replace(nota_componente_curricular.nota_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular.nota_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular,
	           modules.nota_aluno
	     WHERE nota_componente_curricular.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula AND
             nota_componente_curricular.etapa = 2
      ) AS nota2,

       (SELECT CASE  WHEN nota_componente_curricular.nota_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular.nota_arredondada) = 1 THEN
			                   replace(nota_componente_curricular.nota_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular.nota_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular,
	           modules.nota_aluno
	     WHERE nota_componente_curricular.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula AND
             nota_componente_curricular.etapa = 3
      ) AS nota3,

       (SELECT CASE  WHEN nota_componente_curricular.nota_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular.nota_arredondada) = 1 THEN
			                   replace(nota_componente_curricular.nota_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular.nota_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular,
	           modules.nota_aluno
	     WHERE nota_componente_curricular.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula AND
             nota_componente_curricular.etapa = 4
      ) AS nota4,


       (SELECT CASE  WHEN nota_componente_curricular.nota_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular.nota_arredondada) = 1 THEN
			                   replace(nota_componente_curricular.nota_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular.nota_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular,
	           modules.nota_aluno
	     WHERE nota_componente_curricular.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula AND
             nota_componente_curricular.etapa = 'Rc'
      ) AS nota_exame,


       (SELECT CASE  WHEN nota_componente_curricular_media.media_arredondada = 10 THEN
			                   '10,0'
			               WHEN char_length(nota_componente_curricular_media.media_arredondada) = 1 THEN
			                   replace(nota_componente_curricular_media.media_arredondada,'.',',') || ',0'
                           ELSE
                               replace(nota_componente_curricular_media.media_arredondada,'.',',')
                           END
	      FROM modules.nota_componente_curricular_media,
	           modules.nota_aluno
	     WHERE nota_componente_curricular_media.nota_aluno_id = nota_aluno.id AND
	           nota_componente_curricular_media.componente_curricular_id = componente_curricular.id AND
	           nota_aluno.matricula_id = matricula.cod_matricula
      ) AS media,

	         (SELECT curso.nm_curso
                FROM pmieducar.curso
	          WHERE curso.cod_curso = matricula.ref_cod_curso AND
                        curso.ativo = 1) AS nome_curso,

            (SELECT serie.nm_serie
               FROM pmieducar.serie
	         WHERE serie.cod_serie = matricula.ref_ref_cod_serie AND
                       serie.ativo = 1) AS nome_serie,


	    (SELECT turma.nm_turma
	       FROM pmieducar.turma,
                    pmieducar.matricula_turma
              WHERE turma.cod_turma = $P{turma} AND
                    matricula_turma.ref_cod_turma = turma.cod_turma AND
                    matricula_turma.ref_cod_matricula = matricula.cod_matricula AND
                    turma.ativo = 1 AND
		matricula_turma.ativo = 1) AS nome_turma,

       (select turma_turno.nm_turno from pmieducar.turma_turno, pmieducar.turma where turma_turno.turma_turno_id = turma.turma_turno_id and turma.cod_turma = matricula_turma.ref_cod_turma and  instituicao_id = $P{instituicao} limit 1) as periodo,


		(SELECT CASE WHEN (SELECT mt.aprovado
		                     FROM pmieducar.matricula mt
							WHERE mt.cod_matricula = matricula.cod_matricula) = 1 THEN 'Aprovado'
                     WHEN (SELECT mt.aprovado
					         FROM pmieducar.matricula mt
							WHERE mt.cod_matricula = matricula.cod_matricula) = 2 THEN 'Reprovado'
                     WHEN (SELECT mt.aprovado
					         FROM pmieducar.matricula mt
							WHERE mt.cod_matricula = matricula.cod_matricula) = 3 THEN 'Em Andamento'
                     WHEN (SELECT mt.aprovado
					         FROM pmieducar.matricula mt
							WHERE mt.cod_matricula = matricula.cod_matricula) = 4 THEN 'Transferido'
                ELSE 'Reclassificado'
                END) AS situacao,

		(SELECT public.fcn_upper(pessoa.nome)
           FROM cadastro.pessoa,
                cadastro.fisica,
                pmieducar.aluno
          WHERE pessoa.idpes = fisica.idpes AND
                fisica.idpes = aluno.ref_idpes AND
                aluno.cod_aluno = matricula.ref_cod_aluno) AS nome_aluno,

        (SELECT sum(falta_geral.quantidade)
           FROM modules.falta_geral,
                modules.falta_aluno
          WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_geral.etapa = 1 AND
				falta_aluno.tipo_falta = 1) as total_faltas_et1,

        (SELECT sum(falta_geral.quantidade)
           FROM modules.falta_geral,
                modules.falta_aluno
          WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_geral.etapa = 2 AND
				falta_aluno.tipo_falta = 1) as total_faltas_et2,

        (SELECT sum(falta_geral.quantidade)
           FROM modules.falta_geral,
                modules.falta_aluno
          WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_geral.etapa = 3 AND
                falta_aluno.tipo_falta = 1) as total_faltas_et3,

        (SELECT sum(falta_geral.quantidade)
           FROM modules.falta_geral,
                modules.falta_aluno
          WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_geral.etapa = 4 AND
				falta_aluno.tipo_falta = 1) as total_faltas_et4,

        (SELECT sum(falta_geral.quantidade)
           FROM modules.falta_geral,
                modules.falta_aluno
          WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_geral.etapa in ('1','2','3','4')) as total_faltas,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_componente_curricular.etapa = 1 AND
				falta_componente_curricular.componente_curricular_id = componente_curricular.id AND
				falta_aluno.tipo_falta = 2) as faltas_componente_et1,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_componente_curricular.etapa = 2 AND
				falta_componente_curricular.componente_curricular_id = componente_curricular.id AND
				falta_aluno.tipo_falta = 2) as faltas_componente_et2,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_componente_curricular.etapa = 3 AND
				falta_componente_curricular.componente_curricular_id = componente_curricular.id AND
				falta_aluno.tipo_falta = 2) as faltas_componente_et3,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_componente_curricular.etapa = 4 AND
				falta_componente_curricular.componente_curricular_id = componente_curricular.id AND
				falta_aluno.tipo_falta = 2) as faltas_componente_et4,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
				falta_componente_curricular.componente_curricular_id = componente_curricular.id AND
                falta_componente_curricular.etapa in ('1','2','3','4') AND
				falta_aluno.tipo_falta = 2) as total_faltas_componente,

       (SELECT sum(falta_componente_curricular.quantidade)
           FROM modules.falta_componente_curricular,
                modules.falta_aluno
          WHERE falta_componente_curricular.falta_aluno_id = falta_aluno.id AND
                falta_aluno.matricula_id = matricula.cod_matricula AND
                falta_componente_curricular.etapa in ('1','2','3','4') AND
				falta_aluno.tipo_falta = 2) as total_geral_faltas_componente,


  (SELECT to_number((((select serie.dias_letivos
                       from pmieducar.serie
                      where serie.cod_serie = matricula.ref_ref_cod_serie)::float -
                   (SELECT sum(falta_geral.quantidade)
                       FROM modules.falta_geral,
                            modules.falta_aluno
                      WHERE falta_geral.falta_aluno_id = falta_aluno.id AND
                            falta_aluno.matricula_id = matricula.cod_matricula AND
                            falta_geral.etapa in('1','2','3','4')))::float * 100::float )::float / (select serie.dias_letivos from pmieducar.serie where serie.cod_serie = matricula.ref_ref_cod_serie) :: float,'999')) AS frequencia,

    (SELECT sum(to_number(componente_curricular_ano_escolar.carga_horaria,'999'))
       FROM modules.componente_curricular_ano_escolar
     WHERE componente_curricular_ano_escolar.componente_curricular_id = componente_curricular.id) AS            carga_horaria,


(select curso.hora_falta * 100 from pmieducar.curso where curso.cod_curso = matricula.ref_cod_curso) as curso_hora_falta,

  (select carga_horaria :: int from modules.componente_curricular_ano_escolar where   componente_curricular_ano_escolar.componente_curricular_id = componente_curricular.id AND componente_curricular_ano_escolar.ano_escolar_id = matricula.ref_ref_cod_serie) as carga_horaria_componente,

  (select serie.carga_horaria from pmieducar.serie where  serie.cod_serie = matricula.ref_ref_cod_serie) as carga_horaria_serie

 FROM pmieducar.matricula,
 pmieducar.matricula_turma,
 modules.componente_curricular

       WHERE
matricula.ref_ref_cod_escola = $P{escola} AND
  matricula.ref_cod_curso = $P{curso} AND
  matricula.ref_ref_cod_serie = $P{serie} AND
  matricula.ativo = 1 AND
  matricula_turma.ref_cod_turma = $P{turma} AND
  matricula_turma.ativo = 1 AND
  matricula.ano = $P{ano} AND
  matricula_turma.ref_cod_matricula = matricula.cod_matricula and

  (SELECT CASE WHEN $P{matricula} = 0 THEN
    matricula_turma.ref_cod_matricula = matricula.cod_matricula AND
    matricula_turma.ref_cod_turma = $P{turma}
  ELSE
    matricula.cod_matricula = $P{matricula}
  END) and


  CASE WHEN (select 1 from modules.componente_curricular_turma
    WHERE componente_curricular_turma.turma_id = matricula_turma.ref_cod_turma AND
    componente_curricular_turma.escola_id = matricula.ref_ref_cod_escola limit 1) = 1 THEN

    componente_curricular.id in (select componente_curricular_id from modules.componente_curricular_turma
    where componente_curricular_turma.escola_id = matricula.ref_ref_cod_escola AND
    componente_curricular_turma.turma_id = matricula_turma.ref_cod_turma)
  ELSE
    componente_curricular.id in (select ref_cod_disciplina from pmieducar.escola_serie_disciplina
    where escola_serie_disciplina.ref_ref_cod_serie = matricula.ref_ref_cod_serie AND
    escola_serie_disciplina.ref_ref_cod_escola = matricula.ref_ref_cod_escola AND
    escola_serie_disciplina.ativo = 1)
  END

	) AS etapa1
GROUP BY id_disciplina, nome_disciplina, nome_aluno
ORDER BY nome_aluno, nome_disciplina]]>
	</queryString>
	<field name="ano" class="java.lang.Integer"/>
	<field name="nome_responsavel" class="java.lang.String"/>
	<field name="nm_escola" class="java.lang.String"/>
	<field name="nome_instituicao" class="java.lang.String"/>
	<field name="tipo_logradouro" class="java.lang.String"/>
	<field name="logradouro" class="java.lang.String"/>
	<field name="municipio" class="java.lang.String"/>
	<field name="bairro" class="java.lang.String"/>
	<field name="uf_municipio" class="java.lang.String"/>
	<field name="numero" class="java.math.BigDecimal"/>
	<field name="cep" class="java.lang.String"/>
	<field name="fone_ddd" class="java.math.BigDecimal"/>
	<field name="fone" class="java.lang.String"/>
	<field name="email" class="java.lang.String"/>
	<field name="data_atual" class="java.lang.String"/>
	<field name="hora_atual" class="java.lang.String"/>
	<field name="nome_disciplina" class="java.lang.String"/>
	<field name="matricula" class="java.lang.Integer"/>
	<field name="id_disciplina" class="java.lang.Integer"/>
	<field name="nota1" class="java.lang.String"/>
	<field name="nota2" class="java.lang.String"/>
	<field name="nota3" class="java.lang.String"/>
	<field name="nota4" class="java.lang.String"/>
	<field name="nota_exame" class="java.lang.String"/>
	<field name="media" class="java.lang.String"/>
	<field name="nome_curso" class="java.lang.String"/>
	<field name="nome_serie" class="java.lang.String"/>
	<field name="nome_turma" class="java.lang.String"/>
	<field name="periodo" class="java.lang.String"/>
	<field name="situacao" class="java.lang.String"/>
	<field name="nome_aluno" class="java.lang.String"/>
	<field name="total_faltas_et1" class="java.lang.Long"/>
	<field name="total_faltas_et2" class="java.lang.Long"/>
	<field name="total_faltas_et3" class="java.lang.Long"/>
	<field name="total_faltas_et4" class="java.lang.Long"/>
	<field name="total_faltas" class="java.lang.Long"/>
	<field name="faltas_componente_et1" class="java.lang.Long"/>
	<field name="faltas_componente_et2" class="java.lang.Long"/>
	<field name="faltas_componente_et3" class="java.lang.Long"/>
	<field name="faltas_componente_et4" class="java.lang.Long"/>
	<field name="total_faltas_componente" class="java.lang.Long"/>
	<field name="total_geral_faltas_componente" class="java.lang.Long"/>
	<field name="frequencia" class="java.math.BigDecimal"/>
	<field name="carga_horaria_componente" class="java.lang.Integer"/>
	<field name="curso_hora_falta" class="java.lang.Double"/>
	<field name="carga_horaria" class="java.math.BigDecimal"/>
	<field name="carga_horaria_serie" class="java.lang.Double"/>
	<group name="matricula">
		<groupExpression><![CDATA[$F{matricula}]]></groupExpression>
		<groupHeader>
			<band height="156">
				<rectangle>
					<reportElement uuid="91f47c7e-4ae4-4436-8fb3-59896d15288e" x="12" y="5" width="507" height="59"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</rectangle>
				<textField isBlankWhenNull="true">
					<reportElement uuid="369d8cdf-db98-40cb-8635-2b35814d6d47" x="233" y="79" width="100" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{periodo}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement uuid="2b0a7f30-6a63-4bce-ac51-367f89add80a" x="188" y="141" width="165" height="1"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="75afdd5b-f6dd-4e13-ae3a-aa4fcd560c11" x="188" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="30fcda1c-be74-4e31-b4f9-d65051fc1609" x="16" y="96" width="100" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[05 - ALUNO]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="112c332d-d8cb-45fb-8534-a5257bdc11d3" x="345" y="79" width="79" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_serie}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="074ce724-86d6-4e3c-ae23-ad891ff5b3fb" x="189" y="129" width="66" height="11"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[1º SEMESTRE]]></text>
				</staticText>
				<line>
					<reportElement uuid="b72f8cd8-5a89-4312-9f4a-3ebaf0a90d5b" x="12" y="64" width="1" height="91"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="49236eb4-ce25-42e5-ad65-34344edbf471" x="341" y="64" width="1" height="63"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="3c60e509-7592-4faa-9c01-001d71c6cc84" x="433" y="129" width="35" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[Faltas]]></text>
				</staticText>
				<image>
					<reportElement uuid="9c23ea0d-71f2-4a55-8186-d613a8367006" x="22" y="11" width="57" height="46"/>
					<imageExpression><![CDATA[$P{logo}]]></imageExpression>
				</image>
				<staticText>
					<reportElement uuid="89b263ed-0093-47c2-8bb6-34ec551f128b" x="257" y="129" width="9" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[F]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="d6cf006c-54f1-45f8-8add-e097548d607f" x="352" y="34" width="56" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Ano Letivo:]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="29c9319c-d209-422f-9dc2-35de86bcc48d" x="271" y="129" width="66" height="11"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[2º SEMESTRE]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="59c0246f-70b6-4a83-9063-31aad4f26248" x="233" y="66" width="64" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[02 - TURNO]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="7d04cc03-9500-491c-976c-23f8e5babc95" x="17" y="133" width="170" height="14"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[DISCIPLINA]]></text>
				</staticText>
				<line>
					<reportElement uuid="ac7a2088-2662-4940-baa3-3466a343eb22" x="428" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<textField>
					<reportElement uuid="d418e1ff-f7a5-44be-a7cf-f92de84056ed" x="89" y="20" width="253" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_responsavel}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement uuid="b97c4314-be67-4d4d-9a7c-578a1315b7c8" x="429" y="64" width="1" height="31"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="e73b01ff-808c-41d8-8445-059bd0668325" x="13" y="95" width="506" height="1"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<textField isBlankWhenNull="true">
					<reportElement uuid="c13b16d3-fbed-4b43-ba72-5d2c020aad47" x="409" y="34" width="66" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{ano}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="5058f485-edf9-417e-9a5f-8bc880c12b77" x="283" y="49" width="59" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{fone}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="f78781b9-059b-4cdd-8632-a06db17fa0c7" x="288" y="142" width="33" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[NOTA]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="deb79966-4d66-4f6a-b0da-b2c960ca14fe" x="16" y="66" width="68" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[01 - CURSO]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="7c951f05-1df9-4bf3-b3d1-861f1d55322f" x="341" y="129" width="9" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[F]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="525f63e9-7c45-4732-b875-b3819636652a" x="438" y="142" width="26" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{total_faltas}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement uuid="7069ec34-3a67-462e-ad82-3f46158d5a66" x="353" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="797662d1-7916-464f-9f6f-bd3699b6da2b" x="352" y="11" width="136" height="20"/>
					<textElement>
						<font fontName="DejaVu Sans" size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[BOLETIM ESCOLAR]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="db53ada6-c2ad-4ada-85ef-3352b671d8df" x="16" y="79" width="210" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_curso}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="734ea933-70fb-452e-899f-16ebb8478c7c" x="432" y="79" width="76" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_turma}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="ba200ca9-34b6-4962-b192-347dd2b03c64" x="396" y="142" width="30" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[final]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="bc32c86e-6b0d-4de1-8bf7-e5fc5dcca813" x="358" y="142" width="30" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[final]]></text>
				</staticText>
				<line>
					<reportElement uuid="7d05295f-cc9f-48e9-8eba-f8311594fbf3" x="229" y="64" width="1" height="31"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="734b5d90-ee5b-4df8-a9f5-598a0d9f186c" x="13" y="127" width="506" height="1"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="e043a4b5-fecc-43df-b294-c5bb80dc1813" x="432" y="66" width="59" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[04 - TURMA]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="4bcbd8e3-3031-4e2c-bfb2-033fdf117f42" x="345" y="96" width="75" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[06 - SITUAÇÃO]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="774346f5-523a-47c4-a2ae-1a82c17e89fc" x="208" y="142" width="33" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[NOTA]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="cc13b3c2-14fa-4bcd-b6fa-6356a6e1993e" x="89" y="34" width="253" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nm_escola}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="890cbd07-7e85-4ad2-811b-4bf3a751cf37" x="89" y="8" width="253" height="14"/>
					<textElement markup="none">
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_instituicao}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement uuid="7961e3a8-03c6-42a5-80e2-ecbb82ead38d" x="269" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<textField isBlankWhenNull="true">
					<reportElement uuid="ac0c429f-8b80-4781-aa72-c5572fae68c3" x="89" y="49" width="160" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{logradouro}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="01d4b59f-918c-4284-a856-9dd87da206c0" x="352" y="49" width="36" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[E-mail:]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="31f014e4-0d32-4cf4-aeb6-252ab1dd8540" x="356" y="129" width="34" height="11"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[Exame]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="ceee36c0-b4d8-4a0c-871a-5f4dc15779f6" isPrintRepeatedValues="false" x="255" y="142" width="12" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{total_faltas_et1}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="5fe4fed6-7749-4ad1-be70-918fe1f700ed" x="16" y="109" width="242" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nome_aluno}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="f1a6aa76-60c9-4907-9554-119452004799" x="474" y="129" width="34" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[Freq. %]]></text>
				</staticText>
				<line>
					<reportElement uuid="af5fdba1-36ac-441c-9b02-236ace223b8b" x="471" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="0a8bf3e7-0b6f-4e9e-8e82-71fa54156dfb" x="14" y="154" width="505" height="1"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="95675bc5-16d9-4eb9-9260-01504d6e4fab" x="345" y="66" width="58" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<text><![CDATA[03 - SÉRIE]]></text>
				</staticText>
				<line>
					<reportElement uuid="f69a18d1-0da3-47bf-9ed1-f11040857696" x="391" y="127" width="1" height="27"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<textField isBlankWhenNull="true">
					<reportElement uuid="1d32c0f4-44b4-4512-8514-1070fa55ca4b" x="339" y="142" width="12" height="11"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{total_faltas_et2}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="1c63fc60-44eb-494f-a193-e25495b15f42" x="389" y="49" width="127" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{email}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="20034f97-9a5c-40a0-ac49-7a99f424d28e" x="345" y="109" width="93" height="14"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{situacao}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="d8922508-447f-4275-a535-9bcf81fdc600" x="396" y="129" width="30" height="11"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<text><![CDATA[Média]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="ad8d0fbc-ee37-42f8-a895-4c5e2873f6dc" x="251" y="49" width="31" height="15"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Fone:]]></text>
				</staticText>
				<line>
					<reportElement uuid="01e0c6df-a8f8-4d2a-8d83-35e2a309676a" x="519" y="64" width="1" height="91"/>
					<graphicElement>
						<pen lineWidth="0.25"/>
					</graphicElement>
				</line>
				<textField pattern="#,##0 ‰" isBlankWhenNull="true">
					<reportElement uuid="a186a095-592f-4305-9371-f71862d9c46a" x="482" y="142" width="26" height="11"/>
					<textElement textAlignment="Right">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{frequencia}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0 ‰">
					<reportElement uuid="1744a6f4-b690-402c-abdc-60c166c44957" x="482" y="143" width="26" height="11">
						<printWhenExpression><![CDATA[100 - (($F{total_geral_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_serie}) != 100.0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[100 - (($F{total_geral_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_serie})]]></textFieldExpression>
				</textField>
				<textField pattern="###0">
					<reportElement uuid="1744a6f4-b690-402c-abdc-60c166c44957" x="482" y="142" width="26" height="11">
						<printWhenExpression><![CDATA[100 - (($F{total_geral_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_serie}) == 100.0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font fontName="DejaVu Sans" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[100]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="1017fdae-39da-41ac-a63d-2b175117bcd0" x="438" y="142" width="26" height="11" printWhenGroupChanges="matricula"/>
					<textElement textAlignment="Center">
						<font fontName="DejaVu Sans" size="8" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{total_geral_faltas_componente}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="38"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="22" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="17" splitType="Stretch">
			<rectangle>
				<reportElement uuid="d5a45dc8-c214-4074-a65a-5fd4a0b4f6b6" mode="Opaque" x="15" y="0" width="503" height="16" forecolor="#FFFFFF" backcolor="#F0F0F0">
					<printWhenExpression><![CDATA[new Boolean(($V{COLUMN_COUNT} % 2) == 1)]]></printWhenExpression>
				</reportElement>
			</rectangle>
			<textField isBlankWhenNull="true">
				<reportElement uuid="365f8232-f639-4d45-bfad-1ade7a98bac6" x="211" y="1" width="26" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nota1}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="e6405890-bf68-4ac4-bb9f-335cc570c9d0" x="293" y="1" width="26" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nota2}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="b3d5a1ae-940d-47e3-9710-f04b6463caa6" x="16" y="1" width="170" height="15"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nome_disciplina}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="3e10c224-fb8f-43d8-8230-4b1e7fe040de" x="253" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="5c820a3a-10e9-4e49-9f19-a6017c9fd325" x="269" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="53392eec-b9a2-4edc-9fa5-61749dda1500" x="188" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="22ab39e9-c622-47fa-80e7-50362fd2a920" x="12" y="16" width="507" height="1"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="f46948a0-68a2-46cf-b846-6d08b15dbcad" x="12" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="2c46a278-fad3-4db9-aa12-921b0e238aae" x="519" y="-2" width="1" height="18"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="fdb66144-5c74-4bd6-beaf-d80ab7f7082b" x="337" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="a7133535-3e3c-4955-8b9a-f7716c91699e" x="353" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="77f804bf-c15e-4405-a5f2-26b7c33134b1" x="428" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<textField isBlankWhenNull="true">
				<reportElement uuid="aa1ac91e-39bd-4b7c-b22f-7ed85bb8be40" x="398" y="1" width="26" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nota2} >= "0,0" ? $F{media} : ""]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="07214d8e-70a8-4937-96c8-539e8f9b2d21" x="337" y="-14" width="1" height="15"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="9d16bdc1-a854-4c34-b322-07a33c98d72e" x="253" y="-14" width="1" height="15"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<line>
				<reportElement uuid="a2ced8f4-862e-4976-9679-190e050dd009" x="471" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<textField isBlankWhenNull="true">
				<reportElement uuid="2abe429f-e65a-42ea-a956-600a2b3cf2fe" x="360" y="1" width="26" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nota_exame}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="e130d3ce-71f7-4210-8a28-a71751fd3468" x="340" y="1" width="12" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{faltas_componente_et2}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="cfb69ba0-2e8e-44ff-88a0-9d744dddbf65" x="438" y="1" width="26" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total_faltas_componente}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="3c15f5b0-bd2b-4e22-a3e9-9d29af2627ba" x="256" y="1" width="12" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{faltas_componente_et1}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="5091b04c-946b-46a2-9d5d-eda6e979bbcd" x="391" y="-1" width="1" height="17"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<textField isBlankWhenNull="true">
				<reportElement uuid="7a070405-d463-4e82-bf5a-c6c99f075120" x="482" y="1" width="26" height="15">
					<printWhenExpression><![CDATA[100 - (($F{total_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_componente}) == 100.0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[100]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0 ‰" isBlankWhenNull="true">
				<reportElement uuid="aa8070c8-9947-428a-bf94-dc59f5ca9d54" x="482" y="1" width="26" height="15">
					<printWhenExpression><![CDATA[100 - (($F{total_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_componente}) != 100.0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[100 - (($F{total_faltas_componente} * $F{curso_hora_falta})/$F{carga_horaria_componente})]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
