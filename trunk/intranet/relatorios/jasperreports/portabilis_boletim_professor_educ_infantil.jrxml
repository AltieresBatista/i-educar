<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="portabilis_boletim_professor_educ_infantil" language="groovy" pageWidth="625" pageHeight="842" columnWidth="585" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0000000000000004"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="ano" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="instituicao" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="escola" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="curso" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="serie" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[new java.lang.Integer(0)]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT public.fcn_upper(nm_instituicao) AS nome_instituicao,
       public.fcn_upper(nm_responsavel) AS nome_responsavel,
       instituicao.cidade AS cidade_instituicao,
       public.fcn_upper(ref_sigla_uf) AS uf_instituicao,

      (SELECT curso.nm_curso
          FROM pmieducar.curso
         WHERE curso.cod_curso = escola_curso.ref_cod_curso) AS curso,

      (SELECT serie.nm_serie
          FROM pmieducar.serie
         WHERE serie.cod_serie = escola_serie_disciplina.ref_ref_cod_serie) AS serie,

      (SELECT componente_curricular.nome
         FROM modules.componente_curricular
        WHERE componente_curricular.id = escola_serie_disciplina.ref_cod_disciplina) AS nm_componente,

     (SELECT area_conhecimento.nome
        FROM modules.area_conhecimento,
             modules.componente_curricular
       WHERE area_conhecimento.id = componente_curricular.area_conhecimento_id AND
             area_conhecimento.instituicao_id = instituicao.cod_instituicao AND
             componente_curricular.id = escola_serie_disciplina.ref_cod_disciplina) as area_conhecimento,


	         (SELECT COALESCE((SELECT COALESCE (fcn_upper(ps.nome),fcn_upper(juridica.fantasia))
          FROM cadastro.pessoa ps,
               cadastro.juridica
         WHERE escola.ref_idpes = juridica.idpes AND
               juridica.idpes = ps.idpes AND
			   ps.idpes = escola.ref_idpes),(SELECT nm_escola FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS nm_escola,

      (SELECT fcn_upper(substring(logradouro.idtlog from 1 for 1)) ||
              lower(substring(logradouro.idtlog, 2))
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes) AS tipo_logradouro,

      (SELECT COALESCE((SELECT COALESCE((SELECT logradouro.nome
         FROM public.logradouro,
              cadastro.juridica,
              cadastro.pessoa ps,
              cadastro.endereco_pessoa
        WHERE juridica.idpes = ps.idpes AND
              ps.idpes = endereco_pessoa.idpes AND
              endereco_pessoa.idlog = logradouro.idlog AND
              juridica.idpes = escola.ref_idpes),(SELECT endereco_externo.logradouro FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.ref_idpes))),(SELECT logradouro FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS logradouro,

      (SELECT COALESCE((SELECT COALESCE((SELECT bairro.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT endereco_externo.bairro FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.ref_idpes))),(SELECT bairro FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS bairro,

      (SELECT COALESCE((SELECT COALESCE ((SELECT municipio.nome
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes), (SELECT endereco_externo.cidade FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.ref_idpes))),(SELECT municipio FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS municipio,

      (SELECT COALESCE((SELECT COALESCE((SELECT endereco_pessoa.numero
         FROM cadastro.endereco_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT endereco_externo.numero FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.ref_idpes))),(SELECT numero FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS numero,


      (SELECT COALESCE((SELECT COALESCE((SELECT municipio.sigla_uf
         FROM public.municipio,
              cadastro.endereco_pessoa,
              cadastro.juridica,
              public.bairro
        WHERE endereco_pessoa.idbai = bairro.idbai AND
              bairro.idmun = municipio.idmun AND
              juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT endereco_externo.sigla_uf FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.ref_idpes))),(select inst.ref_sigla_uf from pmieducar.instituicao inst where inst.cod_instituicao = instituicao.cod_instituicao))) AS uf_municipio,

     (SELECT COALESCE((SELECT min(fone_pessoa.ddd)
         FROM cadastro.fone_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT min(ddd_telefone) FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS fone_ddd,

     (SELECT COALESCE((SELECT COALESCE((SELECT to_char(endereco_pessoa.cep, '99999-999')
         FROM cadastro.endereco_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = endereco_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT to_char(endereco_externo.cep,'99999-999') FROM cadastro.endereco_externo WHERE endereco_externo.idpes = escola.cod_escola))),(SELECT to_char(escola_complemento.cep,'99999-999') FROM pmieducar.escola_complemento where escola_complemento.ref_cod_escola = escola.cod_escola))) AS cep,


     (SELECT COALESCE((SELECT min(to_char(fone_pessoa.fone, '9999-9999'))
         FROM cadastro.fone_pessoa,
              cadastro.juridica
        WHERE juridica.idpes = fone_pessoa.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT min(to_char(telefone, '9999-9999')) FROM pmieducar.escola_complemento where escola_complemento.ref_cod_escola = escola.cod_escola))) AS fone,

   (SELECT COALESCE((SELECT ps.email
         FROM cadastro.pessoa ps,
              cadastro.juridica
        WHERE juridica.idpes = ps.idpes AND
              juridica.idpes = escola.ref_idpes),(SELECT email FROM pmieducar.escola_complemento where ref_cod_escola = escola.cod_escola))) AS email,

       to_char(CURRENT_DATE,'dd/mm/yyyy') AS data_atual,
       to_char(current_timestamp, 'HH24:MI:SS') AS hora_atual


  FROM pmieducar.escola_serie_disciplina,
       pmieducar.escola_serie,
       pmieducar.escola,
       pmieducar.escola_ano_letivo,
       pmieducar.escola_curso,
       pmieducar.instituicao

WHERE escola.cod_escola = escola_serie_disciplina.ref_ref_cod_escola AND
      escola_serie_disciplina.ref_ref_cod_serie = escola_serie.ref_cod_serie AND
      escola_serie_disciplina.ref_ref_cod_escola = escola_serie.ref_cod_escola AND
      escola.ref_cod_instituicao = instituicao.cod_instituicao AND
      escola_ano_letivo.ref_cod_escola = escola.cod_escola AND
      escola_curso.ref_cod_escola = escola.cod_escola AND
      escola_ano_letivo.ano = $P{ano} AND
      instituicao.ativo = 1 AND
      escola.cod_escola = $P{escola} AND
      escola_curso.ref_cod_curso = $P{curso} AND
      escola_serie.ref_cod_serie = $P{serie} AND
      escola.ativo = 1]]>
	</queryString>
	<field name="nome_instituicao" class="java.lang.String"/>
	<field name="nome_responsavel" class="java.lang.String"/>
	<field name="cidade_instituicao" class="java.lang.String"/>
	<field name="uf_instituicao" class="java.lang.String"/>
	<field name="curso" class="java.lang.String"/>
	<field name="serie" class="java.lang.String"/>
	<field name="nm_componente" class="java.lang.String"/>
	<field name="area_conhecimento" class="java.lang.String"/>
	<field name="nm_escola" class="java.lang.String"/>
	<field name="tipo_logradouro" class="java.lang.String"/>
	<field name="logradouro" class="java.lang.String"/>
	<field name="bairro" class="java.lang.String"/>
	<field name="municipio" class="java.lang.String"/>
	<field name="numero" class="java.math.BigDecimal"/>
	<field name="uf_municipio" class="java.lang.String"/>
	<field name="fone_ddd" class="java.math.BigDecimal"/>
	<field name="cep" class="java.lang.String"/>
	<field name="fone" class="java.lang.String"/>
	<field name="email" class="java.lang.String"/>
	<field name="data_atual" class="java.lang.String"/>
	<field name="hora_atual" class="java.lang.String"/>
	<group name="area_conhecimento">
		<groupExpression><![CDATA[$F{area_conhecimento}]]></groupExpression>
		<groupHeader>
			<band height="31">
				<textField>
					<reportElement x="4" y="3" width="243" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Área de conhecimento: "+$F{area_conhecimento}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="15" y="17" width="142" height="13"/>
					<textElement>
						<font fontName="DejaVu Sans" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Disciplina]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="3"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="78" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="3" splitType="Stretch">
			<staticText>
				<reportElement x="77" y="-74" width="447" height="22"/>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[BOLETIM DO PROFESSOR EDUCAÇÃO INFANTIL]]></text>
			</staticText>
			<textField>
				<reportElement x="354" y="-47" width="93" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Série/Ano: "+$F{serie}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="9" y="-47" width="36" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<text><![CDATA[Aluno:]]></text>
			</staticText>
			<line>
				<reportElement x="45" y="-35" width="205" height="1"/>
			</line>
			<staticText>
				<reportElement x="413" y="-29" width="63" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[1º Semestre]]></text>
			</staticText>
			<staticText>
				<reportElement x="451" y="-47" width="40" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<text><![CDATA[Turma:]]></text>
			</staticText>
			<line>
				<reportElement x="490" y="-35" width="79" height="1"/>
			</line>
			<textField>
				<reportElement x="252" y="-47" width="96" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Curso: "+$F{curso}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="500" y="-29" width="66" height="13"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[2º Semestre]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="3" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement x="15" y="2" width="393" height="13" isPrintWhenDetailOverflows="true"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{nm_componente}]]></textFieldExpression>
			</textField>
			<rectangle>
				<reportElement x="413" y="2" width="80" height="13"/>
			</rectangle>
			<rectangle>
				<reportElement x="500" y="2" width="80" height="13"/>
			</rectangle>
		</band>
	</detail>
	<columnFooter>
		<band height="3" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="3" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="36" splitType="Stretch">
			<staticText>
				<reportElement x="15" y="2" width="42" height="14"/>
				<textElement>
					<font fontName="DejaVu Sans" size="8"/>
				</textElement>
				<text><![CDATA[Parecer:]]></text>
			</staticText>
			<line>
				<reportElement x="59" y="15" width="521" height="1"/>
			</line>
			<line>
				<reportElement x="59" y="32" width="521" height="1"/>
			</line>
		</band>
	</summary>
</jasperReport>
